---

---

# 计算机组成原理

## 起始篇

### 1.1 计算机系统体系结构

![](.\Pictures\计算机系统结构.png '计算机系统的结构')

- Cache一般集成在CPU中，是存放常用数据的高速、专用存储器。
- 主存中存放了大量的工作数据
- 辅存是指磁盘和CD-ROM，价格低廉（相对于前两种），能够存放海量的数据（包括程序和数据）

**思考**：现今绝大多数的计算机都是图灵完备的，这意味着所有的数据能够解决同样的一些问题。换句话说，能由计算机A解决的问题一定能够由计算机B解决。这样看来，即使是未来的计算机也没有办法解决现今计算机无法解决的问题。

计算机的各个子系统通过总线连接在一起，数据通过通过总线从一个位置传输到另外一个位置。系统总线用来连接计算机内部的各个硬件，为了维持各个硬件的高速运转，系统总线的传输速度很快。与此对应的是扩展总线，用来连接外设，速度相对于系统总线要慢，传输的主要是IO数据流以及移动外设的数据。在系统总线与扩展总线之间通过扩展总线接口来联系（除此之外，两个总线互不连通）。

这里讨论的计算机是由约翰·冯·诺依曼等人界定的冯·诺依曼存储程序数据计算机。

![](.\Pictures\存储程序计算机的结构.png '存储程序计算机的结构')

- 主存也叫内存，可以由计算机CPU随时随机存储和读取。
- cache也叫缓存，存取速度要远大于主存（随着CPU的不断升级，内存的存取速度也逐渐跟不上CPU的处理速度），在优化良好的调度算法的支持下，主存的数据先加载进cache中，CPU再从cache中读取，优化良好的可以将主存全部近似为cache。
- 寄存器，CPU的一部分，是CPU内部用来存放数据的存储单元，可用来暂存指令、数据和位址，是中央处理器运算时临时存放数据的器件。寄存器的访问速度是最快的，要远快于CPU外的存储器，同时其造价也是最高昂的，通常一块CPU中只会有一小片寄存器。
- 时钟提供了脉冲流，所有内部操作都在时钟脉冲的触发下进行。时钟频率是决定计算机速度的一个因素。

大部分计算机在CPU与存储器系统之间仅有一条信息通路，数据和指令要轮流使用这条通路，上图之所以要画成两条通路，是为了强调存储器中既保存了组成程序的指令，也保存了程序所用的数据。有的计算机则不同，在不同的存储器中分别存储数据和指令（或使用不同的总线传输）的结构叫做哈佛体系结构（Harvard architecture）。

**计算机指令**：与汇编指令中由计算机而非编译器执行的指令很相似，例如*ADD A,B,C*、*MOV A, B*以及布尔逻辑运算。条件运算或流控制指令是一类重要的计算机运算，它允许了用户从两条路径中选择一条执行（例如：if x=4, then y=5, else y=6）。访问存储器的指令有诸如*LOAD*、*STORE*等。

| 计算机指令 |                             解释                             |
| :--------: | :----------------------------------------------------------: |
|  MOV A, B  |                        将B的值复制到A                        |
| LOAD A, B  |                将存储单元B的值复制到寄存器A中                |
| STORE A, B |                将寄存器B的值复制到存储单元A中                |
|  ADD A, B  |                  将A与B相加，结果保存到A中                   |
|   TEST A   |                       测试A的值是否为0                       |
|   BEQ Z    | 若最后一次的测试结果为TURE，则执行地址Z处的代码，否则继续执行 |

尽管计算机能够执行上百种不同的指令，但上面的6条基本指令可以将所有计算机指令进行分类。例如，ADD指令涵盖了所有的数椐处理指令，如减法、乘法甚至返回A与B的最大值的指令。计算机设计时关注的是设计一组能够高效完成计算的指令。正如我们将要看到的那样，应在增加越来越多“聪明的”能够完成各种复杂计算的指令与增加这些援令带来的开销和复杂度之间进行平衡。

### 1.2 体系构成和组成

我们已经树立了*计算机*和*系统*的概念，还需要定义*体系结构*。之所以要定义计算机体系结构，是因为不同的用户会从完全不同的角度看待计算机。我们所说的计算机体系结构通常是指程序员视角中的计算机。在程序员的视角中，看到的是计算机的抽象视图，在程序员眼中，计算机的实际硬件和实现都被隐藏起来了。

计算机体系结构的这个抽象视图现在被称作**指令集体系结构**（instruction set architecture, **ISA**）。术语*组成*（organization）或者更通常的*微体系结构*（microarchitecture）在计算机文献中出现的频率与体系结构差不多，但其含义并不相同。计算机组成表示其体系结构的具体实现，~~是计算机体系结构的实例化~~。

ISA包括：*数据类型*（每个字的位数以及各个位的含义），*用来储存临时结果的寄存器*，*指令的类型和格式*，以及*寻址方式*（表示数据在存储器中存放位置的方法）。

本书用术语*体系结构*（architecture）代表计算机的抽象指令集体系结构（它的指令集），而用术语*组成*（organization）代表汁算机的实际硬件实现。然而，“组成” 一词也会被用于描述完整的计算机，包括它的CPU、存储器、总线以及输入/输出机制。最后，我们用术语*微体系结构*（microarchitecture）代表CPU的实现。

**时钟**：绝大多数数字电子电路都带有一个*时钟*，用以生成连续的、间隔固定的电脉冲流。之所以被称作时钟，是因为可用这些电脉冲来计时或确定计算机内所有事件的顺序。时钟可用它的重复速率或频率来定义，典型时钟频率即范围在1MHz至4.5GHz之间。在早期，CPU性能的提升主要通过时钟频率的提高（功耗也随之提高），截止至2007年，CPU性能的提高主要通过流水线，[指令集](https://moz-extension.kiwix.org/current/wikipedia_zh_computer_maxi_2023-01.zim/A/指令集)和[多内核](https://moz-extension.kiwix.org/current/wikipedia_zh_computer_maxi_2023-01.zim/A/多核心)技术的创新来实现，而不是时钟频率的提高（时钟频率的提高受到了CPU功耗下降的限制）。

事件由时钟信号触发的数字电路被称作*同步的*，因为它们由时钟信号来同步。例如，如果移动一下鼠标，它会向计算机发送一个信号。这是个异步事件。然而，计算机可以在每个时钟脉冲检测鼠标的状态，这是一个同步事件。

